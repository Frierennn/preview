"use strict";(self["webpackChunkvue_app"]=self["webpackChunkvue_app"]||[]).push([[750],{9750:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"about"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.hide1,expression:"hide1"}],staticStyle:{"text-align":"center"}},[a("br"),a("h1",[t._v("注册体验更多内容")]),a("br"),a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.register()}}},[t._v("注册  >")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.hide2,expression:"hide2"}]},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-card",[a("div",{staticClass:"user-info"},[a("el-avatar",{staticClass:"user-avator",attrs:{src:t.img,fit:"fill"}}),a("div",{staticClass:"user-info-cont"},[a("div",{staticClass:"user-info-name"},[t._v(t._s(t.name))])])],1),a("div",{staticClass:"user-info-list"},[a("p",[t._v("性别："+t._s(t.gender))]),a("p",[t._v("微信号："+t._s(t.phone))]),a("p",[t._v("邮箱："+t._s(t.mail))]),a("p",[t._v("上次登录时间："+t._s(t.date))])])])],1),a("el-col",{attrs:{span:16}},[a("el-card",[a("i",{staticClass:"el-icon-lx-calendar"}),t._v(" 个人信息修改 "),a("el-form",{attrs:{"label-width":"160px",rules:t.rule}},[a("el-form-item",{attrs:{label:"用户头像"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{limit:1,data:t.uploadData,"list-type":"picture-card",action:"http://localhost:3000/users/upload","on-success":t.handleSucess,"before-upload":t.beforeAvatarUpload,"auto-upload":!1},scopedSlots:t._u([{key:"trigger",fn:function(){return[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("选取文件")])]},proxy:!0},{key:"file",fn:function(e){var s=e.file;return a("div",{},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:s.url,alt:""}}),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.handlePictureCardPreview(s)}}},[a("i",{staticClass:"el-icon-zoom-in"})]),t.disabled?t._e():a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleRemove(s)}}},[a("i",{staticClass:"el-icon-delete"})])])])}}])}),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),a("el-form-item",{attrs:{label:"用户名",prop:"user_name"}},[a("el-input",{staticStyle:{width:"160px"},model:{value:t.form.user_name,callback:function(e){t.$set(t.form,"user_name",e)},expression:"form.user_name"}})],1),a("el-form-item",{attrs:{label:"性别"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:t.form.gender,callback:function(e){t.$set(t.form,"gender",e)},expression:"form.gender"}},[a("el-option",{key:"girl",attrs:{label:"女",value:"女"}}),a("el-option",{key:"boy",attrs:{label:"男",value:"男"}})],1)],1),a("el-form-item",{attrs:{label:"微信号"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),a("el-form-item",{attrs:{label:"自我介绍"}},[a("el-input",{staticStyle:{width:"200px；height: 320px"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit()}}},[t._v("确定")]),a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.reset()}}},[t._v("重置密码  >")])],1)],1)],1)],1)],1),a("br"),a("el-row",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("我的文章")]),a("div",{staticClass:"handle-box",staticStyle:{float:"right",padding:"3px 0",width:"50%"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"搜索",clearable:""},model:{value:t.searchContent.searchContent0,callback:function(e){t.$set(t.searchContent,"searchContent0",e)},expression:"searchContent.searchContent0"}}),t._v("  "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.handleSearch(0)}}},[t._v("搜索")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:function(e){return t.remtableData(0)}}},[t._v("重置")])],1),a("el-dialog",{attrs:{title:"提示",visible:t.editVisible,width:"30%"},on:{"update:visible":function(e){t.editVisible=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span",{staticClass:"dialog-footer"},[a("el-button",{on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.del()}}},[t._v("确 定")])],1)]},proxy:!0}])},[t._v(" 确定要删除吗？ ")])],1),a("el-table",{staticClass:"table",attrs:{data:t.tableData,border:"","header-cell-class-name":"table-header",height:"500px"}},[a("el-table-column",{attrs:{label:"文章标题",width:"417px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{attrs:{to:{path:"/notedetail/"+e.row.fq+e.row.id}}},[t._v(" "+t._s(e.row.title)+" ")])]}}])}),a("el-table-column",{attrs:{label:"发布时间",width:"94",prop:"date",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.date))]}}])}),a("el-table-column",{attrs:{label:"收藏数",width:"88",prop:"collection",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.collection))]}}])}),a("el-table-column",{attrs:{label:"点赞数",width:"88",prop:"zan",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.zan))]}}])}),a("el-table-column",{attrs:{label:"访问数",width:"88",prop:"fan",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.fan))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"}},[a("router-link",{attrs:{to:{path:"/notechange/"+t.fq+e.row.id}}},[t._v(" 编辑 ")])],1),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return t.handleDelete(e.$index,e.row)}}},[t._v(" 删除 ")])]}}])})],1)],1)],1),a("br"),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("我的关注")]),a("div",{staticClass:"handle-box",staticStyle:{float:"right",padding:"3px 0",width:"70%"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"搜索",clearable:""},model:{value:t.searchContent.searchContent1,callback:function(e){t.$set(t.searchContent,"searchContent1",e)},expression:"searchContent.searchContent1"}}),t._v("  "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-search"},on:{click:function(e){return t.handleSearch(1)}}},[t._v("搜索")]),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.remtableData(1)}}},[t._v("重置")])],1)]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.followtableData,"show-header":!1,height:"200px"}},[a("el-table-column",{attrs:{width:"width: 100%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticStyle:{display:"flex","flex-flow":"row","align-items":"center"},attrs:{to:{path:"/user",query:{index:e.row.user_no}}}},[a("el-avatar",{attrs:{size:"medium",src:"http://localhost:3000/uploads/"+e.row.user_no+".jpg"}}),t._v("   "),a("div",[t._v(t._s(e.row.user_name))])],1)]}}])})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("我的收藏")]),a("div",{staticClass:"handle-box",staticStyle:{float:"right",padding:"3px 0",width:"70%"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"搜索",clearable:""},model:{value:t.searchContent.searchContent2,callback:function(e){t.$set(t.searchContent,"searchContent2",e)},expression:"searchContent.searchContent2"}}),t._v("  "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-search"},on:{click:function(e){return t.handleSearch(2)}}},[t._v("搜索")]),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.remtableData(2)}}},[t._v("重置")])],1)]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.collectableData,"show-header":!1,height:"200px"}},[a("el-table-column",{attrs:{width:"width: 100%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{attrs:{to:{path:"/notedetail/"+e.row.notesid}}},[t._v(" "+t._s(e.row.title)+" ")])]}}])})],1)],1)],1)],1),a("br"),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("我的粉丝")]),a("div",{staticClass:"handle-box",staticStyle:{float:"right",padding:"3px 0",width:"70%"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"搜索",clearable:""},model:{value:t.searchContent.searchContent3,callback:function(e){t.$set(t.searchContent,"searchContent3",e)},expression:"searchContent.searchContent3"}}),t._v("  "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-search"},on:{click:function(e){return t.handleSearch(3)}}},[t._v("搜索")]),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return t.remtableData(3)}}},[t._v("重置")])],1)]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.usertableData,"show-header":!1,height:"200px"}},[a("el-table-column",{attrs:{width:"width: 100%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{display:"flex","flex-flow":"row",width:"100%"}},[a("router-link",{staticStyle:{display:"flex","flex-flow":"row","align-items":"center",width:"80%"},attrs:{to:{path:"/user",query:{index:e.row.user_no}}}},[a("el-avatar",{attrs:{size:"medium",src:"http://localhost:3000/uploads/"+e.row.user_no+".jpg"}}),t._v("   "),a("div",[t._v(t._s(e.row.user_name))])],1),a("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"确定要移除该粉丝？"},on:{confirm:function(a){return t.deluser(e.row.user_no)}}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.hide2,expression:"hide2"}],attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("移除粉丝")])],1)],1)]}}])})],1)],1)],1)],1)],1)])},l=[],r=a(4959),o=a(9669),i=a.n(o),n={data(){return{collectableData:[],mcollectableData:[],followtableData:[],mfollowtableData:[],tableData:[],mtableData:[],usertableData:[],musertableData:[],editVisible:!1,form:{},idx:-1,searchContent:{searchContent0:"",searchContent1:"",searchContent2:"",searchContent3:""},fq:"1",query:{state:r.Z.getCookie("user_no")},dialogImageUrl:"",dialogVisible:!1,disabled:!1,hide1:!0,hide2:!1,uploadData:{no:""},name:"",img:"",gender:"未知",phone:"未知",mail:"未知",date:r.Z.getCookie("date"),form:{address:"",gender:"",phone:"",user_name:""},rule:{user_name:[{pattern:/^[\u4e00-\u9fa5_a-zA-Z0-9.·-]+$/,message:"用户名不支持特殊字符",trigger:"blur"}]}}},methods:{getcollectData(){i().get("/users/collectnotes/",{params:{user_no:this.mail}}).then((t=>{let e=t.data;this.collectableData=e,this.mcollectableData=e}))},getfollowData(){i().get("/users/followlist",{params:{user_no:this.mail}}).then((t=>{this.followtableData=t.data,this.mfollowtableData=t.data})).catch((t=>{console.log(t)}))},getusertableData(){i().get("/users/userlist",{params:{follow_no:this.mail}}).then((t=>{this.usertableData=t.data,this.musertableData=t.data})).catch((t=>{console.log(t)}))},deluser(t){i().get("/users/nouser",{params:{follow_no:this.mail,user_no:t}}).then((t=>{let e=t.data;1==e.flag?(this.getusertableData(),this.$notify({title:"成功",message:e.msg,type:"success"})):this.$notify.error({title:"错误",message:e.msg})})).catch((t=>{console.log(t)}))},del(){i().get("/upload/notedel/"+this.fq+this.form.id).then((()=>{this.editVisible=!1,this.$message.success("删除成功"),this.tableData.splice(this.idx,1)})).catch((t=>{console.log(t)}))},handleDelete(t,e){this.idx=t,this.form=e,this.editVisible=!0},handleSearch(t){var e=this.searchContent[Object.keys(this.searchContent)[t]]&&this.searchContent[Object.keys(this.searchContent)[t]].toLowerCase();if(0==t){var a=this.tableData;this.tableData=e?a.filter((function(t){return Object.keys(t).some((function(a){return String(t[a]).toLowerCase().match(e)}))})):a}else if(1==t){a=this.followtableData;this.followtableData=e?a.filter((function(t){return Object.keys(t).some((function(a){return String(t[a]).toLowerCase().match(e)}))})):a}else if(2==t){a=this.collectableData;this.collectableData=e?a.filter((function(t){return Object.keys(t).some((function(a){return String(t[a]).toLowerCase().match(e)}))})):a}else{a=this.usertableData;this.usertableData=e?a.filter((function(t){return Object.keys(t).some((function(a){return String(t[a]).toLowerCase().match(e)}))})):a}},getnotesData(){i().get("/upload/infonotes/"+this.mail).then((t=>{let e=t.data;this.tableData=e,this.mtableData=e,this.getcollectData(),this.getfollowData(),this.getusertableData()}))},handleRemove(t){this.$refs["upload"].clearFiles()},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},register(){this.$router.push({path:"/Register"})},reset(){this.$router.push({path:"/Reset"})},beforeAvatarUpload(t){const e="image/jpeg"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a},handleSucess(t,e){console.log(URL.createObjectURL(e.raw))},getCookie(t){for(var e=t+"=",a=document.cookie.split(";"),s=0;s<a.length;s++){var l=a[s].trim();if(0==l.indexOf(e))return l.substring(e.length,l.length)}return""},remtableData(t){0==t?this.tableData=this.mtableData:1==t?this.followtableData=this.mfollowtableData:2==t?this.collectableData=this.mcollectableData:this.usertableData=this.musertableData},checkuserno(){var t=this.getCookie("user_no");""!=t&&(0==t?console.log("游客已登录"):(this.hide1=!1,this.hide2=!0,this.getUserdata()))},getUserdata(){i().get("/users/mydata").then((t=>{let e=t.data[0];this.form.gender=e.gender,this.form.address=e.address,this.form.phone=e.phone,this.form.user_name=e.user_name,this.name=e.user_name,this.img=e.img,this.phone=e.phone,this.gender=e.gender,this.mail=e.user_no,this.uploadData.no=e.user_no,this.getnotesData()})).catch((t=>{console.log(t)}))},onSubmit(){var t=/^[\u4e00-\u9fa5_a-zA-Z0-9.·-]+$/;t.test(this.form.user_name)?(this.$refs.upload.submit(),i().post("/users/update",{user_name:this.form.user_name,phone:this.form.phone,gender:this.form.gender,address:this.form.address}).then((t=>{let e=t.data;1==e.affectedRows&&(this.$message.success("修改成功！"),window.parent.window.location.reload())})).catch((t=>{console.log(t)}))):this.$notify.error({title:"错误",message:"用户名不支持特殊字符"})}},mounted(){this.checkuserno()}},c=n,u=a(1001),d=(0,u.Z)(c,s,l,!1,null,"3c5d01fc",null),h=d.exports}}]);
//# sourceMappingURL=750.05d39d16.js.map